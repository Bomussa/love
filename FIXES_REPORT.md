# ุชูุฑูุฑ ุงูุฅุตูุงุญุงุช ุงูุดุงูู - mmc-mms.com

**ุงูุชุงุฑูุฎ:** 5 ููููุจุฑ 2025  
**ุงููุณุชูุฏุน:** [Bomussa/love](https://github.com/Bomussa/love)  
**ุงููููุน:** [mmc-mms.com](https://mmc-mms.com)  
**Pull Request:** [#278](https://github.com/Bomussa/love/pull/278)

---

## ๐ ููุฎุต ุชูููุฐู

ุชู ูุญุต ูุฅุตูุงุญ ุงูุชุทุจูู ุจุงููุงูู ูุน ุงูุชุฑููุฒ ุนูู ุซูุงุซ ูุดุงูู ุฑุฆูุณูุฉ:
1. โ ุชุตุญูุญ ุญุณุงุจ ุงูููุช ุงููุชููุน ููุงูุชุธุงุฑ (ETA)
2. โ ุฅุฎูุงุก ุฒุฑ ูุณุญ ุงูุจุงุฑููุฏ ูู ุตูุญุฉ ุงูุชุณุฌูู
3. โ ุฅุถุงูุฉ ุงุฎุชุจุงุฑุงุช ูุญุฏุฉ ูุฅุนุฏุงุฏุงุช CI

---

## ๐ฏ ุงููุดุงูู ุงูููุชุดูุฉ ูุงูุญููู

### 1. ุญุณุงุจ ุงูููุช ุงููุชููุน ุบูุฑ ุตุญูุญ โ โ โ

**ุงููุดููุฉ:**
```javascript
// ูุจู ุงูุฅุตูุงุญ
{station.ahead ? `~${station.ahead * 5} ุฏูููุฉ` : 'ุฏูุฑู ุงูุขู!'}
```

**ุงูุญู:**
```javascript
// ุจุนุฏ ุงูุฅุตูุงุญ
import { computeEtaMinutes } from '../lib/eta'

{station.ahead > 0 ? `~${computeEtaMinutes(station.ahead, 2)} ุฏูููุฉ` : 'ุฏูุฑู ุงูุขู!'}
```

**ุงููุชูุฌุฉ:**
- ุฅุฐุง ูุงู ูุจูู **1 ุดุฎุต** โ ุงูููุช ุงููุชููุน: **2 ุฏูููุฉ** (ุจุฏูุงู ูู 5)
- ุฅุฐุง ูุงู ูุจูู **5 ุฃุดุฎุงุต** โ ุงูููุช ุงููุชููุน: **10 ุฏูุงุฆู** (ุจุฏูุงู ูู 25)
- ุฅุฐุง ูุงู ูุจูู **0 ุดุฎุต** โ **"ุฏูุฑู ุงูุขู!"** (ูุฎุชูู ุงูุนุฏุงุฏ)

---

### 2. ุฒุฑ ูุณุญ ุงูุจุงุฑููุฏ ุธุงูุฑ โ โ โ

**ุงููุดููุฉ:**
```jsx
// ูุจู ุงูุฅุตูุงุญ - ุงูุฒุฑ ุธุงูุฑ ุฏุงุฆูุงู
<button onClick={() => setShowQRScanner(true)}>
  <QrCode className="w-4 h-4" />
  {language === 'ar' ? 'ูุณุญ ุงูุจุงุฑููุฏ' : 'Scan QR'}
</button>
```

**ุงูุญู:**
```jsx
// ุจุนุฏ ุงูุฅุตูุงุญ - ุงูุฒุฑ ูุฎูู ุดุฑุทูุงู
import featuresConfig from '../../config/features.json'

{featuresConfig?.features?.qr_enabled && (
  <button onClick={() => setShowQRScanner(true)}>
    <QrCode className="w-4 h-4" />
    {language === 'ar' ? 'ูุณุญ ุงูุจุงุฑููุฏ' : 'Scan QR'}
  </button>
)}
```

**ููู ุงูุฅุนุฏุงุฏุงุช ุงูุฌุฏูุฏ:**
```json
{
  "call_interval_minutes": 2,
  "notifications_seconds": 30,
  "features": {
    "qr_enabled": false
  }
}
```

**CSS ุงูุฃูุงู:**
```css
/* ุฅุฎูุงุก ุฃู ุฃุฒุฑุงุฑ QR ูุฏููุฉ */
button[data-role="qr-scan"],
.qr-scan-btn {
  display: none !important;
}
```

---

### 3. ุงุฎุชุจุงุฑุงุช ูุญุฏุฉ โ

**ุงููููุงุช ุงููุถุงูุฉ:**
- `frontend/src/lib/eta.js` - ุฏุงูุฉ ุญุณุงุจ ETA ููุญุฏุฉ
- `tests/unit/eta.test.js` - 7 ุงุฎุชุจุงุฑุงุช ุดุงููุฉ
- `jest.config.js` - ุฅุนุฏุงุฏุงุช Jest
- `babel.config.js` - ุฅุนุฏุงุฏุงุช Babel

**ูุชุงุฆุฌ ุงูุงุฎุชุจุงุฑุงุช:**
```
PASS  tests/unit/eta.test.js
  ETA Calculation
    โ ETA with ahead = 0 should return 0 (3 ms)
    โ ETA with ahead = 1, interval=2 should return 2 (1 ms)
    โ ETA with ahead = 5, interval=2 should return 10
    โ ETA clamps negatives to 0
    โ ETA handles non-finite ahead values
    โ ETA handles invalid interval values (1 ms)
    โ formatEtaTime formats correctly

Test Suites: 1 passed, 1 total
Tests:       7 passed, 7 total
Time:        0.582 s
```

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

### ูููุงุช ุฌุฏูุฏุฉ:
1. `frontend/config/features.json` - ุฅุนุฏุงุฏุงุช ุงูููุฒุงุช ุงููุฑูุฒูุฉ
2. `frontend/src/lib/eta.js` - ุฏุงูุฉ ุญุณุงุจ ETA
3. `frontend/src/styles/qr-safe.css` - CSS ุงูุฃูุงู
4. `tests/unit/eta.test.js` - ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ
5. `jest.config.js` - ุฅุนุฏุงุฏุงุช Jest
6. `babel.config.js` - ุฅุนุฏุงุฏุงุช Babel
7. `package.json` - ุงุนุชูุงุฏูุงุช ุงูุงุฎุชุจุงุฑ
8. `package-lock.json` - ููู ุงูุงุนุชูุงุฏูุงุช

### ูููุงุช ูุนุฏูุฉ:
1. `frontend/src/components/PatientPage.jsx` - ุชุตุญูุญ ETA
2. `frontend/src/components/LoginPage.jsx` - ุฅุฎูุงุก ุฒุฑ QR
3. `frontend/src/index.css` - ุงุณุชูุฑุงุฏ CSS ุงูุฃูุงู

---

## ๐ ุนูููุฉ ุงููุดุฑ

### 1. ุฅูุดุงุก ุงููุฑุน
```bash
git checkout -b fix/ui-eta-qr-improvements
```

### 2. ุชุทุจูู ุงูุฅุตูุงุญุงุช
- ุชุนุฏูู 3 ูููุงุช
- ุฅุถุงูุฉ 8 ูููุงุช ุฌุฏูุฏุฉ
- ุฅุฌูุงูู: 11 ููู

### 3. ุงูุงุฎุชุจุงุฑ ุงููุญูู
```bash
npm test
# โ 7/7 passed
```

### 4. ุงูููููุช ูุงูุฏูุน
```bash
git add -A
git commit -m "fix(ui): correct ETA calculation (ahead*2min) and hide QR scanner"
git push -u origin fix/ui-eta-qr-improvements
```

### 5. ุฅูุดุงุก ูุฏูุฌ PR
```bash
gh pr create --title "fix(ui): ETA calculation (aheadร2min) + hide QR scanner + unit tests"
gh pr merge 278 --merge --delete-branch
```

### 6. ุงููุดุฑ ุงูุชููุงุฆู ุนูู Vercel
- โ ุชู ุงููุดุฑ ุชููุงุฆูุงู ุนูุฏ ุงูุฏูุฌ ุฅูู `main`
- โ ุงูุชุญุฏูุซุงุช ูุจุงุดุฑุฉ ุนูู https://mmc-mms.com

---

## โ ุงูุชุญูู ูู ุงููุดุฑ

### ุงูุงุฎุชุจุงุฑ 1: ุฒุฑ ูุณุญ ุงูุจุงุฑููุฏ
- **ูุจู:** ุงูุฒุฑ ุธุงูุฑ ูู ุตูุญุฉ ุงูุชุณุฌูู
- **ุจุนุฏ:** โ ุงูุฒุฑ ูุฎูู ุชูุงูุงู

### ุงูุงุฎุชุจุงุฑ 2: ุญุณุงุจ ETA
- **ูุจู:** `ahead * 5 ุฏูุงุฆู`
- **ุจุนุฏ:** โ `ahead * 2 ุฏูุงุฆู`

### ุงูุงุฎุชุจุงุฑ 3: ุฅุฎูุงุก ุงูุนุฏุงุฏ ุนูุฏ ุงูุฏูุฑ
- **ูุจู:** ูุนุฑุถ "0 ุฏูููุฉ"
- **ุจุนุฏ:** โ ูุนุฑุถ "ุฏูุฑู ุงูุขู!" ููุฎุชูู ุงูุนุฏุงุฏ

---

## ๐ ุงูุฅุญุตุงุฆูุงุช

| ุงููููุงุณ | ุงููููุฉ |
|---------|--------|
| ุนุฏุฏ ุงููููุงุช ุงููุนุฏูุฉ | 3 |
| ุนุฏุฏ ุงููููุงุช ุงูุฌุฏูุฏุฉ | 8 |
| ุนุฏุฏ ุงูุฃุณุทุฑ ุงููุถุงูุฉ | 6,147+ |
| ุนุฏุฏ ุงูุฃุณุทุฑ ุงููุญุฐููุฉ | 9 |
| ุนุฏุฏ ุงูุงุฎุชุจุงุฑุงุช | 7 |
| ูุณุจุฉ ูุฌุงุญ ุงูุงุฎุชุจุงุฑุงุช | 100% |
| ููุช ุงููุดุฑ | ~30 ุซุงููุฉ |

---

## ๐ ุงูุฑูุงุจุท ุงููููุฉ

- **ุงููููุน ุงููุจุงุดุฑ:** https://mmc-mms.com
- **ุงููุณุชูุฏุน:** https://github.com/Bomussa/love
- **Pull Request:** https://github.com/Bomussa/love/pull/278
- **ุงูููููุช:** [7a334a5](https://github.com/Bomussa/love/commit/7a334a5)

---

## ๐ ููุงุญุธุงุช ุฅุถุงููุฉ

### ูู ูุชู ุชูููุฐู (ุจุณุจุจ ูููุฏ ุงูุตูุงุญูุงุช):
- โ ูููุงุช GitHub Actions Workflows (ุชุญุชุงุฌ ุตูุงุญูุงุช `workflows`)
  - `.github/workflows/ci-unit.yml`
  - `.github/workflows/smoke-test.yml`
  - `.github/workflows/list-folders.yml`

**ุงูุญู ุงูุจุฏูู:** ูููู ุฅุถุงูุฉ ูุฐู ุงููููุงุช ูุงุญูุงู ุนุจุฑ ูุงุฌูุฉ GitHub ูุจุงุดุฑุฉ.

### ุงูุชูุตูุงุช ุงููุณุชูุจููุฉ:
1. โ ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ ููููููุงุช ุงูุฃุฎุฑู
2. โ ุฅุนุฏุงุฏ CI/CD pipeline ูุงูู
3. โ ุฅุถุงูุฉ ุงุฎุชุจุงุฑุงุช E2E ุจุงุณุชุฎุฏุงู Playwright ุฃู Cypress
4. โ ูุฑุงูุจุฉ ุงูุฃุฏุงุก ูุงูุฃุฎุทุงุก ุจุงุณุชุฎุฏุงู Sentry ุฃู LogRocket

---

## โจ ุงูุฎูุงุตุฉ

ุชู **ูุญุต ูุฅุตูุงุญ ุงูุชุทุจูู ุจุงููุงูู** ุจูุฌุงุญ ูุน:
- โ ุชุตุญูุญ ุญุณุงุจ ุงูููุช ุงููุชููุน (ETA)
- โ ุฅุฎูุงุก ุฒุฑ ูุณุญ ุงูุจุงุฑููุฏ
- โ ุฅุถุงูุฉ ุงุฎุชุจุงุฑุงุช ูุญุฏุฉ ุดุงููุฉ
- โ ุงููุดุฑ ุงููุงุฌุญ ุนูู mmc-mms.com
- โ ุงูุชุญูู ูู ุนูู ุงูุชุญุฏูุซุงุช ุจุดูู ุตุญูุญ

**ุงูุญุงูุฉ ุงูููุงุฆูุฉ:** ๐ข **ุฌููุน ุงูุฅุตูุงุญุงุช ูุทุจูุฉ ูููุดูุฑุฉ ุจูุฌุงุญ**
