# ﷼۴۶ المستند الموحد: الأمر التنفيذي النهائي المُلزم

> الهدف: تنفيذ ثابت بنسبة موثوقية \*R \> 0.98\* مع ميزانية أخطاء \*\u2264 2\%\*، دون المساس بالهوية البصرية.

## الجزء الأول: الأمر الإجرائي المباشر (التنفيذ الفوري)

| الإجراء المُلزم المطلوب فورًا | المبرر الهندسي (لماذا؟) |
|---|---|
| 1) **Immediate Rollback** إلى آخر إصدار مستقر عند فشل نشر | استمرار الخدمة ومنع انهيار R_Total |
| 2) **Circuit Breaker** على أي اعتماد خارجي/داخلي حيوي | يمنع فشل خدمة واحدة من إسقاط المنظومة |
| 3) **Consistency Fix**: حذف مفتاح الكاش بعد تحديث DB | معالجة Read-After-Write & Stale Cache |

## الجزء الثاني: شروط إعادة النشر (تحقق إلزامي)
- **Regression OK**: إثبات أن اختبارات الانحدار تمر.
- **Monitoring**: لقطة شاشة/دليل أن تنبيه 5xx \u2264 2\% مفعّل (Prometheus/Grafana أو بديله).

## التنفيذ ضمن هذا الريبو
- `vercel.json`: Rewrite واحد فقط `/api/v1/:path*` -> Supabase Functions.
- `index.html`: صفحة فحص اتصال تعرض حالة `/api/v1/healthz`.
- `/.well-known/healthz.json`: Probe ستاتيك لإثبات عمل الواجهة.
- لا إنشـاء لوحدات جديدة أو تغيير هوية بصرية.

## تحقق عملي (>90%)
1) زيارة `/.well-known/healthz.json` = واجهة شغالة.
2) استدعاء `/api/v1/healthz` = المسار شغال (200 أو 401/403 حسب الحماية).

**هذا المستند مُلزم للتنفيذ ويُستخدم كمرجع نشر.**
