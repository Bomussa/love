# ูุงุฆูุฉ ุฌุฏุงูู Supabase

**ุงููุดุฑูุน:** MMC-MMS  
**ุงูุชุงุฑูุฎ:** 08 ููููุจุฑ 2025  
**ุงููุตุฏุฑ:** https://supabase.com/dashboard/project/rujwuruuosffcxazymit

---

## ุฅุญุตุงุฆูุงุช

- **ุฅุฌูุงูู ุงูุฌุฏุงูู:** 30
- **Schema:** public
- **ูุงุนุฏุฉ ุงูุจูุงูุงุช:** PostgreSQL

---

## ูุงุฆูุฉ ุงูุฌุฏุงูู ุงููุงููุฉ

### 1. Core Tables (ุงูุฌุฏุงูู ุงูุฃุณุงุณูุฉ)

| # | ุงุณู ุงูุฌุฏูู | ุงููุตู | RLS |
|---|------------|-------|-----|
| 1 | `admins` | ุงููุณุคูููู | โ |
| 2 | `patients` | ุงููุฑุถู | โ |
| 3 | `clinics` | ุงูุนูุงุฏุงุช | โ |
| 4 | `queue` | ูุงุฆูุฉ ุงูุงูุชุธุงุฑ | โ |
| 5 | `routes` | ุงููุณุงุฑุงุช | โ |
| 6 | `route_steps` | ุฎุทูุงุช ุงููุณุงุฑ | โ |

### 2. Queue Management (ุฅุฏุงุฑุฉ ุงูุทูุงุจูุฑ)

| # | ุงุณู ุงูุฌุฏูู | ุงููุตู | RLS |
|---|------------|-------|-----|
| 7 | `queue_admin_view` | ุนุฑุถ ุฅุฏุงุฑู ููุทุงุจูุฑ | โ๏ธ |
| 8 | `queue_audit` | ุชุฏููู ุงูุทุงุจูุฑ | โ๏ธ |
| 9 | `queue_pending` | ุงูุทุงุจูุฑ ุงููุนูู | โ๏ธ |
| 10 | `queue_resettle` | ุฅุนุงุฏุฉ ุชุฑุชูุจ ุงูุทุงุจูุฑ | โ๏ธ |
| 11 | `queue_backup_20251101_000000` | ูุณุฎุฉ ุงุญุชูุงุทูุฉ | โ |

### 3. Clinic Management (ุฅุฏุงุฑุฉ ุงูุนูุงุฏุงุช)

| # | ุงุณู ุงูุฌุฏูู | ุงููุตู | RLS |
|---|------------|-------|-----|
| 12 | `clinic_counters` | ุนุฏุงุฏุงุช ุงูุนูุงุฏุงุช | โ |
| 13 | `clinic_pins` | ุฃุฑูุงู PIN ููุนูุงุฏุงุช | โ |
| 14 | `clinic_queue_reservations` | ุญุฌูุฒุงุช ุงูุทุงุจูุฑ | โ |

### 4. System & Configuration (ุงููุธุงู ูุงูุฅุนุฏุงุฏุงุช)

| # | ุงุณู ุงูุฌุฏูู | ุงููุตู | RLS |
|---|------------|-------|-----|
| 15 | `app_settings` | ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู | โ |
| 16 | `organization` | ุจูุงูุงุช ุงูููุธูุฉ | โ |
| 17 | `pins` | ุฃุฑูุงู PIN | โ |
| 18 | `sessions` | ุงูุฌูุณุงุช | โ |
| 19 | `ip_sessions` | ุฌูุณุงุช IP | โ |

### 5. Logging & Auditing (ุงูุณุฌูุงุช ูุงูุชุฏููู)

| # | ุงุณู ุงูุฌุฏูู | ุงููุตู | RLS |
|---|------------|-------|-----|
| 20 | `audit_logs` | ุณุฌูุงุช ุงูุชุฏููู | โ |
| 21 | `error_log` | ุณุฌู ุงูุฃุฎุทุงุก | โ๏ธ |
| 22 | `cache_logs` | ุณุฌูุงุช ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ | โ |
| 23 | `events` | ุงูุฃุญุฏุงุซ | โ |

### 6. Reporting & Analytics (ุงูุชูุงุฑูุฑ ูุงูุชุญูููุงุช)

| # | ุงุณู ุงูุฌุฏูู | ุงููุตู | RLS |
|---|------------|-------|-----|
| 24 | `reports` | ุงูุชูุงุฑูุฑ | โ |
| 25 | `chart_data` | ุจูุงูุงุช ุงูุฑุณูู ุงูุจูุงููุฉ | โ |
| 26 | `daily_barcode_usage` | ุงุณุชุฎุฏุงู ุงูุจุงุฑููุฏ ุงููููู | โ |

### 7. Advanced Features (ููุฒุงุช ูุชูุฏูุฉ)

| # | ุงุณู ุงูุฌุฏูู | ุงููุตู | RLS |
|---|------------|-------|-----|
| 27 | `notifications` | ุงูุฅุดุนุงุฑุงุช | โ๏ธ |
| 28 | `rate_limits` | ุญุฏูุฏ ุงููุนุฏู | โ |
| 29 | `call_engine_state` | ุญุงูุฉ ูุญุฑู ุงูุงุณุชุฏุนุงุก | โ |
| 30 | `scheduler_jobs` | ููุงู ุงูุฌุฏููุฉ | โ |

---

## ุชุตููู ุญุณุจ ุงููุธููุฉ

### ุฅุฏุงุฑุฉ ุงููุฑุถู ูุงูุนูุงุฏุงุช (8 ุฌุฏุงูู)
- patients, clinics, queue, clinic_counters, clinic_pins, clinic_queue_reservations, routes, route_steps

### ุฅุฏุงุฑุฉ ุงูุทูุงุจูุฑ (5 ุฌุฏุงูู)
- queue, queue_admin_view, queue_audit, queue_pending, queue_resettle

### ุงููุธุงู ูุงูุฃูุงู (5 ุฌุฏุงูู)
- admins, app_settings, sessions, ip_sessions, pins

### ุงูุณุฌูุงุช ูุงูุชุฏููู (4 ุฌุฏุงูู)
- audit_logs, error_log, cache_logs, events

### ุงูุชูุงุฑูุฑ ูุงูุชุญูููุงุช (3 ุฌุฏุงูู)
- reports, chart_data, daily_barcode_usage

### ุงูููุฒุงุช ุงููุชูุฏูุฉ (4 ุฌุฏุงูู)
- notifications, rate_limits, call_engine_state, scheduler_jobs

### ุฃุฎุฑู (1 ุฌุฏูู)
- organization

---

## ุญุงูุฉ Row Level Security (RLS)

| ุงูุญุงูุฉ | ุงูุนุฏุฏ | ุงููุณุจุฉ |
|--------|------|--------|
| โ ููุนูู | 24 | 80% |
| โ๏ธ ุบูุฑ ููุนูู | 5 | 17% |
| โ ูุณุฎุฉ ุงุญุชูุงุทูุฉ | 1 | 3% |

---

## ุงูุฌุฏุงูู ุงูุชู ุชุญุชุงุฌ RLS

ุงูุฌุฏุงูู ุงูุชุงููุฉ ูููุตุญ ุจุชูุนูู RLS ุนูููุง:

1. `error_log` - ุณุฌู ุงูุฃุฎุทุงุก
2. `notifications` - ุงูุฅุดุนุงุฑุงุช  
3. `queue_admin_view` - ุนุฑุถ ุฅุฏุงุฑู
4. `queue_audit` - ุชุฏููู ุงูุทุงุจูุฑ
5. `queue_pending` - ุงูุทุงุจูุฑ ุงููุนูู

---

## ููุงุญุธุงุช ูููุฉ

1. โ ูุนุธู ุงูุฌุฏุงูู ุงูุฃุณุงุณูุฉ ูุญููุฉ ุจู RLS
2. โ๏ธ ุจุนุถ ุฌุฏุงูู Queue ุบูุฑ ูุญููุฉ (ูุฏ ูููู ููุตูุฏูุง)
3. โ ุฌุฏุงูู Admins ู Patients ูุญููุฉ ุจุดูู ุฌูุฏ
4. ๐ ููุฌุฏ ุฌุฏูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ (queue_backup) ูููู ุฃุฑุดูุชู
5. ๐ ุงููุธุงู ูุณุชุฎุฏู ูุนูุงุฑูุฉ ูุชูุฏูุฉ ูุน ุฌุฏุงูู ุชุฏููู

---

## ุงูุนูุงูุงุช ุงูุฑุฆูุณูุฉ

```
patients (1) โโโ (N) queue
clinics (1) โโโ (N) queue
clinics (1) โโโ (N) clinic_counters
clinics (1) โโโ (N) clinic_pins
routes (1) โโโ (N) route_steps
admins (1) โโโ (N) audit_logs
```

---

**ุขุฎุฑ ุชุญุฏูุซ:** 08 ููููุจุฑ 2025
