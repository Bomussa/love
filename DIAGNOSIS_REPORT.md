# ุชูุฑูุฑ ุงูุชุดุฎูุต ุงูุดุงูู - ุชุทุจูู ุงููุฌูุฉ ุงูุทุจูุฉ

**ุงูุชุงุฑูุฎ:** 25 ุฃูุชูุจุฑ 2025  
**ุงููุดุฑูุน:** love (MMC-MMS)  
**ุงููููุฏุณ:** Senior Software Engineer  
**ุงููุฏู:** ุชุดุฎูุต ุดุงูู ูุฌููุน ุงููุดุงูู ูุฅุนุฏุงุฏ ุฎุทุฉ ุฅุตูุงุญ ูุชูุงููุฉ

---

## ๐ ููุฎุต ุชูููุฐู

### ุงููุถุน ุงูุญุงูู
- **Frontend:** ููุดูุฑ ุนูู Vercel ููุนูู โ
- **Backend API:** ููุดูุฑ ููู ูุง ูุนูู โ (404 ุนูู ุฌููุน endpoints)
- **ุงูุชุฎุฒูู:** ูุณุชุฎุฏู ุฐุงูุฑุฉ ูุคูุชุฉ (Memory Store) - ุบูุฑ ุฏุงุฆู โ๏ธ
- **ุงูุจููุฉ:** ูุฎุชูุทุฉ ุจูู Cloudflare Workers ู Vercel Serverless

---

## ๐ด ุงููุดุงูู ุงูุฑุฆูุณูุฉ ุงูููุชุดูุฉ

### 1. ูุดููุฉ API ุนูู Vercel (ุญุฑุฌุฉ)

**ุงููุตู:**
- ุฌููุน ุทูุจุงุช `/api/*` ุชุนูุฏ `404 NOT_FOUND`
- Vercel ูุง ูุชุนุฑู ุนูู ูุฌูุฏ `/api` ูู Serverless Functions

**ุงูุณุจุจ ุงูุฌุฐุฑู:**
```json
// vercel.json ุงูุญุงูู
{
  "version": 2,
  "functions": {
    "api/index.js": {
      "runtime": "nodejs20.x"
    }
  },
  "rewrites": [
    {
      "source": "/api/:path*",
      "destination": "/api/index.js"
    }
  ]
}
```

**ุงููุดููุฉ:**
- ุงูุชูููู ูุดูุฑ ุฅูู `api/index.js` ููุท
- ููู ุงูุจููุฉ ุงูุญุงููุฉ ุชุญุชูู ุนูู `api/v1/` ูุน endpoints ูููุตูุฉ
- Vercel ูุง ูููู ุจุจูุงุก ุงูู API functions ุจุดูู ุตุญูุญ

---

### 2. ุชุนุงุฑุถ ูู ุงูุจููุฉ (Architecture Conflict)

**ุงููุดููุฉ:**
ุงููุดุฑูุน ูุญุชูู ุนูู **ุจููุชูู ูุฎุชููุชูู ููู API:**

#### ุงูุจููุฉ ุงูุฃููู (Cloudflare Style):
```
src/api/index.ts (Hono framework)
โโโ ูุณุชุฎุฏู Hono router
โโโ ูุณุชุฏุนู core modules ูู src/core/
โโโ ูุตูู ูู Cloudflare Workers
```

#### ุงูุจููุฉ ุงูุซุงููุฉ (Vercel Style):
```
api/index.js (Express-like)
โโโ ูุณุชุฎุฏู Vercel serverless handler
โโโ ูุณุชุฏุนู lib modules ูู api/lib/
โโโ ูุตูู ูู Vercel Functions
```

**ุงููุชูุฌุฉ:**
- ุชุนุงุฑุถ ูู ุงููุณุงุฑุงุช
- ุงุฒุฏูุงุฌูุฉ ูู ุงูููุฏ
- ุนุฏู ูุถูุญ ุฃู API ูุฌุจ ุฃู ูุนูู

---

### 3. ูุดููุฉ ุงูุชุฎุฒูู (Storage Layer)

**ุงููุถุน ุงูุญุงูู:**
```javascript
// api/lib/storage.js
const memoryStore = new Map();
```

**ุงููุดุงูู:**
1. **ุนุฏู ุงูุงุณุชูุฑุงุฑูุฉ:** ุงูุจูุงูุงุช ุชูููุฏ ุนูุฏ ุฅุนุงุฏุฉ ุชุดุบูู Function
2. **ุนุฏู ุงููุดุงุฑูุฉ:** ูู Function invocation ููุง ุฐุงูุฑุฉ ูููุตูุฉ
3. **ููุฏุงู ุงูุจูุงูุงุช:** ูู ุจูุฆุฉ Serverlessุ ุงูุฐุงูุฑุฉ ุบูุฑ ูุถูููุฉ

**ุงูุชุฃุซูุฑ:**
- ููุฏุงู ุจูุงูุงุช ุงููุฑุถู
- ููุฏุงู ุญุงูุฉ ุงูุทูุงุจูุฑ
- ููุฏุงู PINs ุงูููุตุฏุฑุฉ
- ุนุฏู ุฅููุงููุฉ ุชุชุจุน ุงูุฌูุณุงุช

---

### 4. ูุดููุฉ CORS ูุฅุนุฏุงุฏุงุช ุงูุฃูุงู

**ุงููุดููุฉ:**
```javascript
// api/lib/helpers.js
export function setCorsHeaders(res) {
  res.setHeader('Access-Control-Allow-Origin', '*');
  // ...
}
```

**ุงููุถุงูุง:**
- CORS ููุชูุญ ูุฌููุน ุงููุตุงุฏุฑ (`*`)
- ุนุฏู ูุฌูุฏ validation ููู origin
- ูุฎุงุทุฑ ุฃูููุฉ ูุญุชููุฉ

---

### 5. ุนุฏู ุงูุชูุงู API Endpoints

**Endpoints ุงูููููุฏุฉ ุฃู ุบูุฑ ุงูููุชููุฉ:**

ูู ุงูุจููุฉ ุงููุทููุจุฉ ูู ุงููุชุทูุจุงุช:
```
โ /api/v1/events/stream (SSE ููุฅุดุนุงุฑุงุช ุงูููุฑูุฉ)
โ /api/v1/admin/status (ููุญุฉ ุชุญูู ุงูุฅุฏุงุฑุฉ)
โ /api/v1/clinic/exit (ุฎุฑูุฌ ูู ุงูุนูุงุฏุฉ)
โ๏ธ /api/v1/reports/* (ููุฌูุฏุฉ ููู ุบูุฑ ููุชููุฉ)
โ๏ธ /api/v1/route/* (ููุฌูุฏุฉ ููู ูุง ุชุนูู)
```

---

### 6. ูุดููุฉ ูู api/index.js

**ุงููุดุงูู ุงูููุชุดูุฉ:**

#### ุฃ. ุงุณุชุฎุฏุงู ุฎุงุทุฆ ูู storage API:
```javascript
// โ ุฎุทุฃ: ุงุณุชุฎุฏุงู namespace ููุนุงูู ุฃูู
await storage.set('ADMIN', `session:${sessionId}`, sessionData);

// โ ุงูุตุญูุญ: ุงุณุชุฎุฏุงู KV namespace ูุจุงุดุฑุฉ
import { KV_ADMIN } from './lib/storage.js';
await KV_ADMIN.put(`session:${sessionId}`, sessionData);
```

#### ุจ. ุนุฏู ูุฌูุฏ body parser:
```javascript
// req.body ุบูุฑ ูุนุฑูู ูู Vercel functions ุจุดูู ุงูุชุฑุงุถู
const { personalId, gender } = req.body || {};
```

#### ุฌ. ุนุฏู ูุฌูุฏ error handling ุดุงูู

---

### 7. ูุดููุฉ ูู Frontend Configuration

**vite.config.js:**
```javascript
const isGitHubPages = process.env.VITE_DEPLOY_ENV === 'github';
export default defineConfig({
  base: isGitHubPages ? '/love/' : '/',
  // ...
});
```

**ุงููุดููุฉ:**
- ูุง ููุฌุฏ ุชูููู ูู API endpoint
- Frontend ูุง ูุนุฑู ุฃูู ูุฑุณู ุงูุทูุจุงุช
- ุนุฏู ูุฌูุฏ environment variables ููู API URL

---

## ๐ฏ ุงูุฃููููุงุช

### ุฃููููุฉ 1 (ุญุฑุฌุฉ): ุฅุตูุงุญ API ุนูู Vercel
- ุฅุนุงุฏุฉ ููููุฉ vercel.json
- ุชูุญูุฏ ุจููุฉ API
- ุงุฎุชุจุงุฑ ุฌููุน endpoints

### ุฃููููุฉ 2 (ุญุฑุฌุฉ): ุฅุตูุงุญ ูุธุงู ุงูุชุฎุฒูู
- ุฅุนุฏุงุฏ Vercel KV
- ุฃู ุงุณุชุฎุฏุงู ุญู ุชุฎุฒูู ุจุฏูู
- ุถูุงู ุงุณุชูุฑุงุฑูุฉ ุงูุจูุงูุงุช

### ุฃููููุฉ 3 (ุนุงููุฉ): ุงุณุชููุงู API Endpoints
- ุชูููุฐ ุงูู endpoints ุงูููููุฏุฉ
- ุฅุตูุงุญ ุงูู endpoints ุงูููุฌูุฏุฉ
- ุงุฎุชุจุงุฑ ุดุงูู

### ุฃููููุฉ 4 (ูุชูุณุทุฉ): ุชุญุณูู ุงูุฃูุงู
- ุชูููู CORS ุจุดูู ุตุญูุญ
- ุฅุถุงูุฉ authentication
- ุฅุถุงูุฉ rate limiting

### ุฃููููุฉ 5 (ูุชูุณุทุฉ): ุฑุจุท Frontend ุจู Backend
- ุฅุถุงูุฉ environment variables
- ุชูููู API client
- ุงุฎุชุจุงุฑ ุงูุชูุงูู

---

## ๐ ูุงุฆูุฉ ุงููุดุงูู ุงูุชูุตูููุฉ

### ูุดุงูู ุงูุจููุฉ (Architecture)
- [ ] ุชุนุงุฑุถ ุจูู src/api ู api/
- [ ] ุงุฒุฏูุงุฌูุฉ ูู ุงูููุฏ
- [ ] ุนุฏู ูุถูุญ ุงูุจููุฉ ุงููุณุชูุฏูุฉ

### ูุดุงูู API
- [ ] vercel.json ุบูุฑ ุตุญูุญ
- [ ] API endpoints ุชุนูุฏ 404
- [ ] ุนุฏู ูุฌูุฏ body parser
- [ ] ุงุณุชุฎุฏุงู ุฎุงุทุฆ ูู storage API
- [ ] endpoints ููููุฏุฉ ุฃู ุบูุฑ ููุชููุฉ

### ูุดุงูู ุงูุชุฎุฒูู
- [ ] ุงุณุชุฎุฏุงู Memory Store ุบูุฑ ุฏุงุฆู
- [ ] ุนุฏู ุฅุนุฏุงุฏ Vercel KV
- [ ] ููุฏุงู ุงูุจูุงูุงุช ุนูุฏ restart

### ูุดุงูู ุงูุฃูุงู
- [ ] CORS ููุชูุญ ุจุงููุงูู
- [ ] ุนุฏู ูุฌูุฏ authentication
- [ ] ุนุฏู ูุฌูุฏ rate limiting
- [ ] ุนุฏู validation ูููุฏุฎูุงุช

### ูุดุงูู Frontend
- [ ] ุนุฏู ุชูููู API endpoint
- [ ] ุนุฏู ูุฌูุฏ environment variables
- [ ] ุนุฏู ูุฌูุฏ error handling ููู API calls

---

## ๐ง ุงูุญู ุงูููุชุฑุญ (Overview)

### ุงููุฑุญูุฉ 1: ุฅุตูุงุญ ููุฑู (Quick Fix)
1. ุฅุนุงุฏุฉ ููููุฉ vercel.json ุจุดูู ุตุญูุญ
2. ุชูุญูุฏ API ูู api/index.js
3. ุฅุตูุงุญ storage API calls
4. ูุดุฑ ูุงุฎุชุจุงุฑ

### ุงููุฑุญูุฉ 2: ุฅุตูุงุญ ุงูุชุฎุฒูู
1. ุฅุนุฏุงุฏ Vercel KV ุฃู ุจุฏูู
2. ุชุญุฏูุซ storage layer
3. ุงุฎุชุจุงุฑ ุงุณุชูุฑุงุฑูุฉ ุงูุจูุงูุงุช

### ุงููุฑุญูุฉ 3: ุงุณุชููุงู Features
1. ุชูููุฐ endpoints ุงูููููุฏุฉ
2. ุฅุตูุงุญ endpoints ุงูููุฌูุฏุฉ
3. ุงุฎุชุจุงุฑ ุดุงูู

### ุงููุฑุญูุฉ 4: ุงูุชุญุณููุงุช
1. ุชุญุณูู ุงูุฃูุงู
2. ุฅุถุงูุฉ monitoring
3. ุชุญุณูู ุงูุฃุฏุงุก

---

## ๐ ุงูุชูููู ุงูููู

### ููุงุท ุงูููุฉ โ
- Frontend ูุจูู ุจุดูู ุงุญุชุฑุงูู (React + Vite)
- UI/UX ุฌูุฏ ููุชูุงูู ูุน ุงููุชุทูุจุงุช
- ุงูููุฏ ููุธู ูููุณู ุจุดูู ุฌูุฏ
- ุงุณุชุฎุฏุงู TypeScript ูู ุจุนุถ ุงูุฃุฌุฒุงุก
- ูุฌูุฏ documentation ุฌูุฏ

### ููุงุท ุงูุถุนู โ
- ุชุนุงุฑุถ ูู ุงูุจููุฉ ุจูู Cloudflare ู Vercel
- API ูุง ูุนูู ุนูู ุงูุฅุทูุงู
- ูุธุงู ุชุฎุฒูู ุบูุฑ ููุงุณุจ ูู production
- ุนุฏู ุงูุชูุงู ุจุนุถ features
- ุนุฏู ูุฌูุฏ ุงุฎุชุจุงุฑุงุช ุชูุงูู

### ุงููุฎุงุทุฑ โ๏ธ
- ููุฏุงู ุงูุจูุงูุงุช ุจุณุจุจ Memory Store
- ุนุฏู ุฅููุงููุฉ ุงุณุชุฎุฏุงู ุงูุชุทุจูู ูู production
- ูุดุงูู ุฃูููุฉ ูุญุชููุฉ
- ุนุฏู ูุงุจููุฉ ุงูุชูุณุน (Scalability)

---

## ๐ฏ ุงูุฎุทูุฉ ุงูุชุงููุฉ

ุณูุชู ุงูุขู ุชุตููู **ุญู ููุฏุณู ุดุงูู** ูุนุงูุฌ ุฌููุน ุงููุดุงูู ุงููุฐููุฑุฉ ุฃุนูุงู ุจุดูู ูููุฌู ููุชูุงูู.

---

**ููุงูุฉ ุชูุฑูุฑ ุงูุชุดุฎูุต**

