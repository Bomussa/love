<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MMC-MMS Test - Standalone</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; display: flex; align-items: center; justify-content: center; }
        .container { background: white; padding: 2rem; border-radius: 1rem; box-shadow: 0 10px 40px rgba(0,0,0,0.2); max-width: 500px; width: 90%; }
        h1 { color: #667eea; margin-bottom: 1.5rem; text-align: center; }
        .form-group { margin-bottom: 1.5rem; }
        label { display: block; margin-bottom: 0.5rem; font-weight: 600; color: #333; }
        input, select { width: 100%; padding: 0.75rem; border: 2px solid #e0e0e0; border-radius: 0.5rem; font-size: 1rem; transition: border-color 0.3s; }
        input:focus, select:focus { outline: none; border-color: #667eea; }
        button { width: 100%; padding: 1rem; background: #667eea; color: white; border: none; border-radius: 0.5rem; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: background 0.3s; }
        button:hover { background: #5568d3; }
        .result { margin-top: 1.5rem; padding: 1rem; background: #f0f7ff; border-left: 4px solid #667eea; border-radius: 0.5rem; display: none; }
        .result.show { display: block; }
        .result h3 { color: #667eea; margin-bottom: 0.5rem; }
        .result p { margin: 0.25rem 0; color: #555; }
        .success { background: #d4edda; border-left-color: #28a745; }
        .success h3 { color: #28a745; }
        .error { background: #f8d7da; border-left-color: #dc3545; }
        .error h3 { color: #dc3545; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ¥ MMC-MMS Standalone Test</h1>
        
        <div class="form-group">
            <label for="patientId">Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø´Ø®ØµÙŠ / Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠ</label>
            <input type="text" id="patientId" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù…..." />
        </div>
        
        <div class="form-group">
            <label for="gender">Ø§Ù„Ø¬Ù†Ø³</label>
            <select id="gender">
                <option value="">Ø§Ø®ØªØ±...</option>
                <option value="male">Ø°ÙƒØ±</option>
                <option value="female">Ø£Ù†Ø«Ù‰</option>
            </select>
        </div>
        
        <button onclick="testLogin()">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
        
        <div id="result" class="result"></div>
    </div>

    <script>
        // Local Storage API Implementation
        class LocalAPI {
            constructor() {
                this.prefix = 'mmc_test_';
                this.init();
            }
            
            init() {
                if (!localStorage.getItem(this.prefix + 'patients')) {
                    localStorage.setItem(this.prefix + 'patients', JSON.stringify({}));
                }
            }
            
            async login(patientId, gender) {
                try {
                    // Validate
                    if (!patientId || !gender) {
                        return { success: false, error: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„' };
                    }
                    
                    if (!/^\d{2,12}$/.test(patientId)) {
                        return { success: false, error: 'Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ø´Ø®ØµÙŠ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 2-12 Ø±Ù‚Ù…' };
                    }
                    
                    // Create session
                    const sessionId = Date.now() + '-' + Math.random().toString(36).substr(2, 9);
                    const data = {
                        id: sessionId,
                        patientId: patientId,
                        gender: gender,
                        loginTime: new Date().toISOString(),
                        status: 'logged_in'
                    };
                    
                    // Store
                    const patients = JSON.parse(localStorage.getItem(this.prefix + 'patients') || '{}');
                    patients[sessionId] = data;
                    localStorage.setItem(this.prefix + 'patients', JSON.stringify(patients));
                    
                    return {
                        success: true,
                        data: data,
                        message: 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­ âœ…'
                    };
                } catch (error) {
                    return { success: false, error: error.message };
                }
            }
        }
        
        const api = new LocalAPI();
        
        async function testLogin() {
            const patientId = document.getElementById('patientId').value;
            const gender = document.getElementById('gender').value;
            const resultDiv = document.getElementById('result');
            
            resultDiv.innerHTML = '<h3>â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ³Ø¬ÙŠÙ„...</h3>';
            resultDiv.className = 'result show';
            
            const result = await api.login(patientId, gender);
            
            if (result.success) {
                resultDiv.className = 'result show success';
                resultDiv.innerHTML = `
                    <h3>âœ… ${result.message}</h3>
                    <p><strong>Session ID:</strong> ${result.data.id}</p>
                    <p><strong>Patient ID:</strong> ${result.data.patientId}</p>
                    <p><strong>Gender:</strong> ${result.data.gender}</p>
                    <p><strong>Login Time:</strong> ${new Date(result.data.loginTime).toLocaleString('ar-SA')}</p>
                    <p><strong>Status:</strong> ${result.data.status}</p>
                `;
            } else {
                resultDiv.className = 'result show error';
                resultDiv.innerHTML = `
                    <h3>âŒ Ø®Ø·Ø£</h3>
                    <p>${result.error}</p>
                `;
            }
        }
        
        // Test on load
        console.log('âœ… Standalone test page loaded successfully');
        console.log('âœ… LocalStorage API initialized');
        console.log('âœ… Ready for testing');
    </script>
</body>
</html>

