# Ø§Ù„Ø­Ù„ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ Ø§Ù„Ø´Ø§Ù…Ù„ - ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„Ø¬Ù†Ø© Ø§Ù„Ø·Ø¨ÙŠØ©

**Ø§Ù„ØªØ§Ø±ÙŠØ®:** 25 Ø£ÙƒØªÙˆØ¨Ø± 2025  
**Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ:** Senior Software Engineer  
**Ø§Ù„Ù‡Ø¯Ù:** Ø­Ù„ Ù…ØªÙƒØ§Ù…Ù„ Ø¨Ù†Ø³Ø¨Ø© 100% Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ù…ÙƒØªØ´ÙØ©

---

## ğŸ¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©

1. âœ… Ø¥ØµÙ„Ø§Ø­ API Ù„ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ÙƒØ§Ù…Ù„ Ø¹Ù„Ù‰ Vercel
2. âœ… Ø¶Ù…Ø§Ù† Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (Data Persistence)
3. âœ… Ø§Ø³ØªÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ endpoints Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
4. âœ… Ø±Ø¨Ø· Frontend Ø¨Ù€ Backend Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
5. âœ… ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ù…Ø§Ù† ÙˆØ§Ù„Ø£Ø¯Ø§Ø¡
6. âœ… Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¨ØµØ±ÙŠØ© 100%
7. âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ ÙˆØªÙˆØ«ÙŠÙ‚ ÙƒØ§Ù…Ù„

---

## ğŸ—ï¸ Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©

### Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠ Ø§Ù„Ù…Ø®ØªØ§Ø±: **Monorepo Ø¹Ù„Ù‰ Vercel**

```
love/
â”œâ”€â”€ api/                          # Backend API (Vercel Serverless)
â”‚   â”œâ”€â”€ index.js                  # Main API Router
â”‚   â”œâ”€â”€ lib/                      # Shared Libraries
â”‚   â”‚   â”œâ”€â”€ storage.js           # Storage Layer (Vercel KV)
â”‚   â”‚   â”œâ”€â”€ helpers.js           # Helper Functions
â”‚   â”‚   â”œâ”€â”€ routing.js           # Routing Logic
â”‚   â”‚   â””â”€â”€ reports.js           # Reports Generation
â”‚   â””â”€â”€ package.json             # API Dependencies
â”‚
â”œâ”€â”€ src/                          # Frontend (React + Vite)
â”‚   â”œâ”€â”€ components/              # React Components
â”‚   â”œâ”€â”€ config/                  # Configuration
â”‚   â”œâ”€â”€ core/                    # Core Business Logic
â”‚   â””â”€â”€ api/                     # API Client
â”‚
â”œâ”€â”€ public/                       # Static Assets
â”œâ”€â”€ vercel.json                   # Vercel Configuration
â”œâ”€â”€ package.json                  # Main Dependencies
â””â”€â”€ vite.config.js               # Vite Configuration
```

**Ø§Ù„Ù…Ø¨Ø±Ø±Ø§Øª:**
- âœ… ØªØ¨Ø³ÙŠØ· Ø§Ù„Ù†Ø´Ø± (Single deployment)
- âœ… Ù…Ø´Ø§Ø±ÙƒØ© Ø§Ù„ÙƒÙˆØ¯ Ø¨ÙŠÙ† Frontend Ùˆ Backend
- âœ… Ø³Ù‡ÙˆÙ„Ø© Ø§Ù„ØµÙŠØ§Ù†Ø© ÙˆØ§Ù„ØªØ·ÙˆÙŠØ±
- âœ… ØªÙƒÙ„ÙØ© Ø£Ù‚Ù„ (Ù…Ø´Ø±ÙˆØ¹ ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Vercel)

---

## ğŸ”§ Ø§Ù„Ø­Ù„ÙˆÙ„ Ø§Ù„ØªÙØµÙŠÙ„ÙŠØ©

### Ø§Ù„Ø­Ù„ 1: Ø¥ØµÙ„Ø§Ø­ API Ø¹Ù„Ù‰ Vercel

#### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:
- `vercel.json` Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ø§ ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
- API ÙŠØ¹ÙŠØ¯ 404 Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª

#### Ø§Ù„Ø­Ù„:

**Ø£. Ø¥Ø¹Ø§Ø¯Ø© Ù‡ÙŠÙƒÙ„Ø© api/index.js:**

```javascript
/**
 * Main API Handler for Vercel Serverless Functions
 * Handles ALL /api/* requests
 */

import { KV_ADMIN, KV_PINS, KV_QUEUES, KV_EVENTS, KV_LOCKS, KV_CACHE } from './lib/storage.js';
import { setCorsHeaders, validateRequest, parseBody } from './lib/helpers.js';
import { calculateDynamicRoute, optimizeRoute } from './lib/routing.js';
import { generateDailyReport, generateWeeklyReport, generateMonthlyReport, generateAnnualReport } from './lib/reports.js';

export default async function handler(req, res) {
  // Set CORS headers
  setCorsHeaders(res);

  // Handle OPTIONS for CORS preflight
  if (req.method === 'OPTIONS') {
    return res.status(200).end();
  }

  // Parse request
  const url = new URL(req.url, `https://${req.headers.host}`);
  const pathname = url.pathname;
  const method = req.method;

  // Parse body for POST/PUT requests
  let body = {};
  if (method === 'POST' || method === 'PUT') {
    body = await parseBody(req);
  }

  try {
    // Router logic here...
    // Ø³ÙŠØªÙ… ØªÙ†ÙÙŠØ° Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ endpoints
    
  } catch (error) {
    console.error('API Error:', error);
    return res.status(500).json({
      success: false,
      error: 'Internal server error',
      message: process.env.NODE_ENV === 'development' ? error.message : undefined
    });
  }
}
```

**Ø¨. ØªØ­Ø¯ÙŠØ« vercel.json:**

```json
{
  "version": 2,
  "buildCommand": "npm run build",
  "outputDirectory": "dist",
  "functions": {
    "api/index.js": {
      "runtime": "nodejs20.x",
      "memory": 1024,
      "maxDuration": 10
    }
  },
  "rewrites": [
    {
      "source": "/api/:path*",
      "destination": "/api/index.js"
    }
  ],
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        { "key": "X-Frame-Options", "value": "SAMEORIGIN" },
        { "key": "X-Content-Type-Options", "value": "nosniff" },
        { "key": "Referrer-Policy", "value": "no-referrer" },
        { "key": "Permissions-Policy", "value": "geolocation=(), microphone=(), camera=()" },
        {
          "key": "Content-Security-Policy",
          "value": "default-src 'self'; img-src 'self' data: https:; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; connect-src 'self' https:; frame-ancestors 'self';"
        }
      ]
    }
  ]
}
```

---

### Ø§Ù„Ø­Ù„ 2: Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¯Ø§Ø¦Ù…

#### Ø§Ù„Ù…Ø´ÙƒÙ„Ø©:
- Ø§Ø³ØªØ®Ø¯Ø§Ù… Memory Store ÙŠØ¤Ø¯ÙŠ Ù„ÙÙ‚Ø¯Ø§Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª

#### Ø§Ù„Ø­Ù„: Ø§Ø³ØªØ®Ø¯Ø§Ù… Vercel KV + File-based Fallback

**Ø£. ØªØ­Ø¯ÙŠØ« api/lib/storage.js:**

```javascript
/**
 * Enhanced Storage Layer
 * - Primary: Vercel KV (if configured)
 * - Fallback: File-based storage (for development)
 * - Cache: In-memory (for performance)
 */

import fs from 'fs/promises';
import path from 'path';

const DATA_DIR = '/tmp/mmc-data'; // Vercel /tmp persists during function lifecycle
const memoryCache = new Map();

class EnhancedStorage {
  constructor(namespace) {
    this.namespace = namespace;
  }

  async get(key) {
    const fullKey = `${this.namespace}:${key}`;
    
    // 1. Check memory cache
    if (memoryCache.has(fullKey)) {
      const cached = memoryCache.get(fullKey);
      if (!cached.expiresAt || Date.now() < cached.expiresAt) {
        return cached.value;
      }
      memoryCache.delete(fullKey);
    }
    
    // 2. Try Vercel KV
    if (process.env.KV_REST_API_URL && process.env.KV_REST_API_TOKEN) {
      try {
        const response = await fetch(
          `${process.env.KV_REST_API_URL}/get/${encodeURIComponent(fullKey)}`,
          {
            headers: {
              Authorization: `Bearer ${process.env.KV_REST_API_TOKEN}`,
            },
          }
        );
        
        if (response.ok) {
          const data = await response.json();
          const value = data.result ? JSON.parse(data.result) : null;
          
          // Cache in memory
          if (value) {
            memoryCache.set(fullKey, { value, expiresAt: null });
          }
          
          return value;
        }
      } catch (error) {
        console.warn('Vercel KV get error:', error.message);
      }
    }
    
    // 3. Fallback to file storage
    try {
      const filePath = path.join(DATA_DIR, this.namespace, `${key}.json`);
      const data = await fs.readFile(filePath, 'utf-8');
      const parsed = JSON.parse(data);
      
      // Check expiration
      if (parsed.expiresAt && Date.now() > parsed.expiresAt) {
        await fs.unlink(filePath).catch(() => {});
        return null;
      }
      
      // Cache in memory
      memoryCache.set(fullKey, { value: parsed.value, expiresAt: parsed.expiresAt });
      
      return parsed.value;
    } catch (error) {
      return null;
    }
  }

  async put(key, value, options = {}) {
    const fullKey = `${this.namespace}:${key}`;
    const stringValue = JSON.stringify(value);
    const expiresAt = options.expirationTtl 
      ? Date.now() + (options.expirationTtl * 1000)
      : null;
    
    // 1. Update memory cache
    memoryCache.set(fullKey, { value, expiresAt });
    
    // 2. Try Vercel KV
    if (process.env.KV_REST_API_URL && process.env.KV_REST_API_TOKEN) {
      try {
        const url = new URL(`${process.env.KV_REST_API_URL}/set/${encodeURIComponent(fullKey)}`);
        if (options.expirationTtl) {
          url.searchParams.set('ex', options.expirationTtl.toString());
        }
        
        await fetch(url.toString(), {
          method: 'POST',
          headers: {
            Authorization: `Bearer ${process.env.KV_REST_API_TOKEN}`,
          },
          body: stringValue,
        });
      } catch (error) {
        console.warn('Vercel KV put error:', error.message);
      }
    }
    
    // 3. Write to file storage (async, don't wait)
    this._writeToFile(key, value, expiresAt).catch(err => {
      console.warn('File storage write error:', err.message);
    });
  }

  async _writeToFile(key, value, expiresAt) {
    const dir = path.join(DATA_DIR, this.namespace);
    await fs.mkdir(dir, { recursive: true });
    
    const filePath = path.join(dir, `${key}.json`);
    await fs.writeFile(filePath, JSON.stringify({ value, expiresAt }), 'utf-8');
  }

  async delete(key) {
    const fullKey = `${this.namespace}:${key}`;
    
    // 1. Remove from memory
    memoryCache.delete(fullKey);
    
    // 2. Try Vercel KV
    if (process.env.KV_REST_API_URL && process.env.KV_REST_API_TOKEN) {
      try {
        await fetch(
          `${process.env.KV_REST_API_URL}/del/${encodeURIComponent(fullKey)}`,
          {
            method: 'POST',
            headers: {
              Authorization: `Bearer ${process.env.KV_REST_API_TOKEN}`,
            },
          }
        );
      } catch (error) {
        console.warn('Vercel KV delete error:', error.message);
      }
    }
    
    // 3. Delete file
    try {
      const filePath = path.join(DATA_DIR, this.namespace, `${key}.json`);
      await fs.unlink(filePath);
    } catch (error) {
      // Ignore
    }
  }

  async list(options = {}) {
    const prefix = options.prefix || '';
    const keys = [];
    
    // Try file storage
    try {
      const dir = path.join(DATA_DIR, this.namespace);
      const files = await fs.readdir(dir);
      
      for (const file of files) {
        if (file.endsWith('.json')) {
          const key = file.replace('.json', '');
          if (!prefix || key.startsWith(prefix)) {
            keys.push({ name: key });
          }
        }
      }
    } catch (error) {
      // Directory doesn't exist yet
    }
    
    return { keys };
  }
}

// Export namespaces
export const KV_ADMIN = new EnhancedStorage('admin');
export const KV_PINS = new EnhancedStorage('pins');
export const KV_QUEUES = new EnhancedStorage('queues');
export const KV_EVENTS = new EnhancedStorage('events');
export const KV_LOCKS = new EnhancedStorage('locks');
export const KV_CACHE = new EnhancedStorage('cache');
```

**Ø§Ù„Ù…Ø²Ø§ÙŠØ§:**
- âœ… ÙŠØ¹Ù…Ù„ Ø¨Ø¯ÙˆÙ† Vercel KV (Ù„Ù„ØªØ·ÙˆÙŠØ± ÙˆØ§Ù„Ø§Ø®ØªØ¨Ø§Ø±)
- âœ… ÙŠØ³ØªØ®Ø¯Ù… Vercel KV ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ØªØ§Ø­Ø§Ù‹
- âœ… Cache ÙÙŠ Ø§Ù„Ø°Ø§ÙƒØ±Ø© Ù„Ù„Ø£Ø¯Ø§Ø¡
- âœ… File-based fallback Ù„Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©

---

### Ø§Ù„Ø­Ù„ 3: Ø§Ø³ØªÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ API Endpoints

#### Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù€ Endpoints Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:

```javascript
// Status & Health
GET  /api/v1/status                    âœ… Ù…ÙˆØ¬ÙˆØ¯

// Patient Management
POST /api/v1/patient/login             âœ… Ù…ÙˆØ¬ÙˆØ¯
GET  /api/v1/patient/:id               âš ï¸ ÙŠØ­ØªØ§Ø¬ Ø¥Ø¶Ø§ÙØ©

// Queue Management
POST /api/v1/queue/enter               âœ… Ù…ÙˆØ¬ÙˆØ¯
GET  /api/v1/queue/status              âœ… Ù…ÙˆØ¬ÙˆØ¯
POST /api/v1/queue/call                âœ… Ù…ÙˆØ¬ÙˆØ¯
POST /api/v1/queue/done                âœ… Ù…ÙˆØ¬ÙˆØ¯

// PIN Management
POST /api/v1/pin/generate              âœ… Ù…ÙˆØ¬ÙˆØ¯
POST /api/v1/pin/verify                âœ… Ù…ÙˆØ¬ÙˆØ¯
GET  /api/v1/pin/status                âš ï¸ ÙŠØ­ØªØ§Ø¬ Ø¥Ø¶Ø§ÙØ©

// Route Management
POST /api/v1/route/create              âš ï¸ ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†
GET  /api/v1/route/:visitId            âš ï¸ ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†
POST /api/v1/route/markClinicDone      âš ï¸ ÙŠØ­ØªØ§Ø¬ ØªØ­Ø³ÙŠÙ†

// Reports
GET  /api/v1/reports/daily             âœ… Ù…ÙˆØ¬ÙˆØ¯
GET  /api/v1/reports/weekly            âŒ Ù…ÙÙ‚ÙˆØ¯
GET  /api/v1/reports/monthly           âŒ Ù…ÙÙ‚ÙˆØ¯
GET  /api/v1/reports/annual            âŒ Ù…ÙÙ‚ÙˆØ¯

// Statistics
GET  /api/v1/stats/dashboard           âœ… Ù…ÙˆØ¬ÙˆØ¯
GET  /api/v1/stats/queues              âŒ Ù…ÙÙ‚ÙˆØ¯

// Events (SSE)
GET  /api/v1/events/stream             âŒ Ù…ÙÙ‚ÙˆØ¯ (Ø­Ø±Ø¬)

// Admin
GET  /api/v1/admin/status              âŒ Ù…ÙÙ‚ÙˆØ¯
POST /api/v1/admin/settings            âŒ Ù…ÙÙ‚ÙˆØ¯

// Clinic
POST /api/v1/clinic/exit               âŒ Ù…ÙÙ‚ÙˆØ¯
```

**Ø³ÙŠØªÙ… ØªÙ†ÙÙŠØ° Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ endpoints Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.**

---

### Ø§Ù„Ø­Ù„ 4: Ø±Ø¨Ø· Frontend Ø¨Ù€ Backend

#### Ø£. Ø¥Ø¶Ø§ÙØ© Environment Variables:

**Ù…Ù„Ù `.env` Ù„Ù„ØªØ·ÙˆÙŠØ±:**
```env
VITE_API_URL=http://localhost:5173
VITE_API_BASE=/api/v1
```

**Ù…Ù„Ù `.env.production` Ù„Ù„Ø¥Ù†ØªØ§Ø¬:**
```env
VITE_API_URL=https://love-snowy-three.vercel.app
VITE_API_BASE=/api/v1
```

#### Ø¨. Ø¥Ù†Ø´Ø§Ø¡ API Client:

**Ù…Ù„Ù `src/lib/api-client.js`:**
```javascript
/**
 * API Client for Frontend
 * Centralized API communication
 */

const API_URL = import.meta.env.VITE_API_URL || '';
const API_BASE = import.meta.env.VITE_API_BASE || '/api/v1';

class APIClient {
  constructor() {
    this.baseURL = `${API_URL}${API_BASE}`;
  }

  async request(endpoint, options = {}) {
    const url = `${this.baseURL}${endpoint}`;
    
    const config = {
      method: options.method || 'GET',
      headers: {
        'Content-Type': 'application/json',
        ...options.headers,
      },
    };

    if (options.body) {
      config.body = JSON.stringify(options.body);
    }

    try {
      const response = await fetch(url, config);
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }

      return await response.json();
    } catch (error) {
      console.error(`API Error [${endpoint}]:`, error);
      throw error;
    }
  }

  // Convenience methods
  get(endpoint, options) {
    return this.request(endpoint, { ...options, method: 'GET' });
  }

  post(endpoint, body, options) {
    return this.request(endpoint, { ...options, method: 'POST', body });
  }

  put(endpoint, body, options) {
    return this.request(endpoint, { ...options, method: 'PUT', body });
  }

  delete(endpoint, options) {
    return this.request(endpoint, { ...options, method: 'DELETE' });
  }

  // Specific API methods
  async getStatus() {
    return this.get('/status');
  }

  async patientLogin(personalId, gender) {
    return this.post('/patient/login', { personalId, gender });
  }

  async enterQueue(sessionId, clinicId) {
    return this.post('/queue/enter', { sessionId, clinicId });
  }

  async getQueueStatus(clinicId) {
    return this.get(`/queue/status?clinicId=${clinicId}`);
  }

  // ... Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ù€ methods
}

export const apiClient = new APIClient();
export default apiClient;
```

#### Ø¬. ØªØ­Ø¯ÙŠØ« vite.config.js:

```javascript
import { defineConfig, loadEnv } from 'vite'
import react from '@vitejs/plugin-react'
import path from 'path'

export default defineConfig(({ mode }) => {
  const env = loadEnv(mode, process.cwd(), '');
  
  return {
    base: '/',
    plugins: [react()],
    resolve: {
      alias: {
        "@": path.resolve(__dirname, "./src"),
      },
    },
    server: {
      port: 5173,
      host: true,
      strictPort: false,
      proxy: {
        '/api': {
          target: env.VITE_API_URL || 'http://localhost:5173',
          changeOrigin: true,
        }
      }
    },
    build: {
      outDir: 'dist',
      assetsDir: 'assets',
      sourcemap: false,
      minify: 'terser'
    }
  };
});
```

---

### Ø§Ù„Ø­Ù„ 5: ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ø£Ù…Ø§Ù†

#### Ø£. CORS Ù…Ø­Ø¯ÙˆØ¯:

```javascript
// api/lib/helpers.js
export function setCorsHeaders(res) {
  const allowedOrigins = [
    'https://love-snowy-three.vercel.app',
    'http://localhost:5173',
    'http://localhost:3000'
  ];
  
  const origin = req.headers.origin;
  
  if (allowedOrigins.includes(origin)) {
    res.setHeader('Access-Control-Allow-Origin', origin);
  }
  
  res.setHeader('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS');
  res.setHeader('Access-Control-Allow-Headers', 'Content-Type, Authorization');
  res.setHeader('Access-Control-Max-Age', '86400');
}
```

#### Ø¨. Rate Limiting:

```javascript
// api/lib/rate-limiter.js
const requests = new Map();

export function checkRateLimit(ip, limit = 100, window = 60000) {
  const now = Date.now();
  const key = `${ip}:${Math.floor(now / window)}`;
  
  const count = requests.get(key) || 0;
  
  if (count >= limit) {
    return false;
  }
  
  requests.set(key, count + 1);
  
  // Cleanup old entries
  if (requests.size > 1000) {
    const cutoff = now - window * 2;
    for (const [k, v] of requests.entries()) {
      const timestamp = parseInt(k.split(':')[1]) * window;
      if (timestamp < cutoff) {
        requests.delete(k);
      }
    }
  }
  
  return true;
}
```

#### Ø¬. Input Validation:

```javascript
// api/lib/validators.js
export function validatePersonalId(id) {
  // Qatari ID: 11 digits
  return /^\d{11}$/.test(id);
}

export function validateGender(gender) {
  return ['male', 'female'].includes(gender);
}

export function validateClinicId(clinicId) {
  const validClinics = ['LAB', 'XRAY', 'DENTAL', 'GENERAL', 'CARDIO'];
  return validClinics.includes(clinicId);
}

export function sanitizeInput(input) {
  if (typeof input !== 'string') return input;
  return input.trim().replace(/[<>]/g, '');
}
```

---

## ğŸ“‹ Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ° Ø§Ù„Ù…Ø±Ø­Ù„ÙŠØ©

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 1: Ø§Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø§Ù„Ø­Ø±Ø¬Ø© (2-3 Ø³Ø§Ø¹Ø§Øª)
1. âœ… Ø¥ØµÙ„Ø§Ø­ api/index.js
2. âœ… Ø¥ØµÙ„Ø§Ø­ api/lib/storage.js
3. âœ… Ø¥ØµÙ„Ø§Ø­ api/lib/helpers.js (body parser + CORS)
4. âœ… ØªØ­Ø¯ÙŠØ« vercel.json
5. âœ… Ø§Ø®ØªØ¨Ø§Ø± API endpoints Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 2: Ø§Ø³ØªÙƒÙ…Ø§Ù„ Features (3-4 Ø³Ø§Ø¹Ø§Øª)
1. âœ… ØªÙ†ÙÙŠØ° endpoints Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø©
2. âœ… ØªØ­Ø³ÙŠÙ† endpoints Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©
3. âœ… Ø¥Ø¶Ø§ÙØ© validation Ø´Ø§Ù…Ù„
4. âœ… Ø¥Ø¶Ø§ÙØ© error handling

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 3: Ø±Ø¨Ø· Frontend (1-2 Ø³Ø§Ø¹Ø©)
1. âœ… Ø¥Ù†Ø´Ø§Ø¡ API client
2. âœ… Ø¥Ø¶Ø§ÙØ© environment variables
3. âœ… ØªØ­Ø¯ÙŠØ« components Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… API client
4. âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ØªÙƒØ§Ù…Ù„

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 4: Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª (1-2 Ø³Ø§Ø¹Ø©)
1. âœ… ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ù…Ø§Ù†
2. âœ… Ø¥Ø¶Ø§ÙØ© rate limiting
3. âœ… ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡
4. âœ… Ø¥Ø¶Ø§ÙØ© logging

### Ø§Ù„Ù…Ø±Ø­Ù„Ø© 5: Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆØ§Ù„ØªÙˆØ«ÙŠÙ‚ (2-3 Ø³Ø§Ø¹Ø§Øª)
1. âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø´Ø§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù
2. âœ… Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£Ø¯Ø§Ø¡
3. âœ… ÙƒØªØ§Ø¨Ø© Ø§Ù„ØªÙˆØ«ÙŠÙ‚
4. âœ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±

---

## âœ… Ù…Ø¹Ø§ÙŠÙŠØ± Ø§Ù„Ù†Ø¬Ø§Ø­

1. âœ… Ø¬Ù…ÙŠØ¹ API endpoints ØªØ¹Ù…Ù„ ÙˆØªØ¹ÙŠØ¯ 200 OK
2. âœ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø§ ØªÙÙÙ‚Ø¯ Ø¹Ù†Ø¯ restart
3. âœ… Frontend ÙŠØªÙˆØ§ØµÙ„ Ù…Ø¹ Backend Ø¨Ù†Ø¬Ø§Ø­
4. âœ… Ù„Ø§ ØªÙˆØ¬Ø¯ Ø£Ø®Ø·Ø§Ø¡ ÙÙŠ Console
5. âœ… Ø§Ù„Ù‡ÙˆÙŠØ© Ø§Ù„Ø¨ØµØ±ÙŠØ© Ù„Ù… ØªØªØºÙŠØ±
6. âœ… Ø²Ù…Ù† Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© < 500ms
7. âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù ØªØ¹Ù…Ù„ ÙƒÙ…Ø§ Ù‡Ùˆ Ù…ØªÙˆÙ‚Ø¹
8. âœ… Ø§Ù„ØªÙˆØ«ÙŠÙ‚ ÙƒØ§Ù…Ù„ ÙˆÙˆØ§Ø¶Ø­

---

## ğŸš€ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©

**Ø³ÙŠØªÙ… Ø§Ù„Ø¢Ù† Ø§Ù„Ø¨Ø¯Ø¡ ÙÙŠ ØªÙ†ÙÙŠØ° Ø§Ù„Ø­Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ù†Ù‡Ø¬ÙŠ ÙˆÙ…ØªØ³Ù„Ø³Ù„.**

---

**Ù†Ù‡Ø§ÙŠØ© Ø®Ø·Ø© Ø§Ù„Ø­Ù„ Ø§Ù„Ù‡Ù†Ø¯Ø³ÙŠ**

