# Prometheus Configuration (Add-only)
#
# Scrapes metrics from Pushgateway and evaluates alert rules
# Alert rules are defined in rules.yml

global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    monitor: 'mmc-mms-monitor'
    environment: 'ci'

# Load alert rules
rule_files:
  - '/etc/prometheus/rules.yml'

# Alertmanager configuration (optional, for production)
# alerting:
#   alertmanagers:
#     - static_configs:
#         - targets: ['alertmanager:9093']

# Scrape configurations
scrape_configs:
  # Scrape Prometheus itself
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']
        labels:
          instance: 'prometheus'

  # Scrape Pushgateway for batch job metrics
  - job_name: 'pushgateway'
    honor_labels: true
    static_configs:
      - targets: ['pushgateway:9091']
        labels:
          instance: 'pushgateway'

  # Scrape Grafana metrics (optional)
  - job_name: 'grafana'
    static_configs:
      - targets: ['grafana:3000']
        labels:
          instance: 'grafana'
